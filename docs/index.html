<!DOCTYPE HTML>
<!--
	Landed by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
  <link rel="icon" type="image/png" href="images/icon.png">
  <title>Chat game example</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="assets/css/main.css" />
  <noscript>
    <link rel="stylesheet" href="assets/css/noscript.css" />
  </noscript>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-M9CVEWYBHS"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-M9CVEWYBHS', {
      'anonymize_ip': true,
    });
  </script>
</head>

<body class="is-preload">
  <div id="page-wrapper">

    <!-- Header -->
    <header id="header">
      <h1 id="logo"><a href="#">Example</a></h1>
      <nav id="nav">
        <ul>
          <li>
            <a href="#">Pages</a>
            <ul>
              <li><a href="#">Left Sidebar</a></li>
              <li><a href="#">Right Sidebar</a></li>
              <li><a href="#">No Sidebar</a></li>
              <li>
                <a href="#">Submenu</a>
                <ul>
                  <li><a href="#">Option 1</a></li>
                  <li><a href="#">Option 2</a></li>
                  <li><a href="#">Option 3</a></li>
                  <li><a href="#">Option 4</a></li>
                </ul>
              </li>
            </ul>
          </li>
          <li>boryssyk@gmail.com</li>
          <li><a href="#" class="button primary">Sign Up</a></li>
        </ul>
      </nav>
    </header>

    <!-- Main -->
    <div id="main" class="wrapper style1">
      <div class="container">
        <header class="major">
          <h2>Example</h2>
          <p>This is an example of your web page and logo</p>
        </header>
        <div class="row gtr-150">
          <div class="col-4 col-12-medium">

            <!-- Sidebar -->
            <section id="sidebar">
              <section>
                <h3>Magna Feugiat</h3>
                <p>Sed tristique purus vitae volutpat commodo suscipit amet sed nibh. Proin a
                  ullamcorper sed blandit. Sed tristique purus vitae volutpat commodo suscipit
                  ullamcorper commodo suscipit amet sed nibh. Proin a ullamcorper sed blandit..</p>
                <footer>
                  <ul class="actions">
                    <li><a href="#" class="button">Learn More</a></li>
                  </ul>
                </footer>
              </section>
              <hr />
              <section>
                <a href="#" class="image fit"><img src="images/pic03.png" alt="" /></a>
                <h3>Amet Lorem Tempus</h3>
                <p>Sed tristique purus vitae volutpat commodo suscipit amet sed nibh. Proin a
                  ullamcorper sed blandit. Sed tristique purus vitae volutpat commodo suscipit
                  ullamcorper sed blandit lorem ipsum dolore.</p>
                <footer>
                  <ul class="actions">
                    <li><a href="#" class="button">Learn More</a></li>
                  </ul>
                </footer>
              </section>
            </section>

          </div>
          <div class="col-8 col-12-medium imp-medium">

            <!-- Content -->
            <section id="content">
              <a href="#" class="image "><img src="images/pic03.png" alt="" /></a>
              <h3>Dolore Amet Consequat</h3>
              <p>Aliquam massa urna, imperdiet sit amet mi non, bibendum euismod est. Curabitur mi justo,
                tincidunt vel eros ullamcorper, porta cursus justo. Cras vel neque eros. Vestibulum diam
                quam, mollis at magna consectetur non, malesuada quis augue. Morbi tincidunt pretium
                interdum est. Curabitur mi justo, tincidunt vel eros ullamcorper, porta cursus justo.
                Cras vel neque eros. Vestibulum diam.</p>
              <p>Vestibulum diam quam, mollis at consectetur non, malesuada quis augue. Morbi tincidunt
                pretium interdum. Morbi mattis elementum orci, nec dictum porta cursus justo. Quisque
                ultricies lorem in ligula condimentum, et egestas turpis sagittis. Cras ac nunc urna.
                Nullam eget lobortis purus. Phasellus vitae tortor non est placerat tristique.</p>
              <h3>Sed Magna Ornare</h3>
              <p>In vestibulum massa quis arcu lobortis tempus. Nam pretium arcu in odio vulputate luctus.
                Suspendisse euismod lorem eget lacinia fringilla. Sed sed felis justo. Nunc sodales elit
                in laoreet aliquam. Nam gravida, nisl sit amet iaculis porttitor, risus nisi rutrum
                metus.</p>
              <ul>
                <li>Faucibus orci lobortis ac adipiscing integer.</li>
                <li>Col accumsan arcu mi aliquet placerat.</li>
                <li>Lobortis vestibulum ut magna tempor massa nascetur.</li>
                <li>Blandit massa non blandit tempor interdum.</li>
                <li>Lacinia mattis arcu nascetur lobortis.</li>
              </ul>
            </section>

          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer id="footer">
      <ul class="icons">
        <li><a href="#" class="icon brands alt fa-twitter"><span class="label">Twitter</span></a></li>
        <li><a href="#" class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>
        <li><a href="#" class="icon brands alt fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
        <li><a href="#" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
        <li><a href="#" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
        <li><a href="#" class="icon solid alt fa-envelope"><span class="label">Email</span></a></li>
      </ul>
      <ul class="credits">
        <li><a href="https://www.linkedin.com/in/pawel-borysiuk/">LinkedIn</a></li>
        <li>boryssyk@gmail.com</li>
      </ul>
      <ul class="copyright">
        <li>&copy; Untitled. All rights reserved.</li>
        <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
      </ul>
    </footer>

  </div>


  <!-- Scripts -->
  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/jquery.scrolly.min.js"></script>
  <script src="assets/js/jquery.dropotron.min.js"></script>
  <script src="assets/js/jquery.scrollex.min.js"></script>
  <script src="assets/js/browser.min.js"></script>
  <script src="assets/js/breakpoints.min.js"></script>
  <script src="assets/js/util.js"></script>
  <script src="assets/js/main.js"></script>
  <!-- 🔹 Кнопка вызова чата -->
  <div id="chat-toggle">💬</div>

  <!-- 🔹 Окно чата -->
  <div id="chat-window">
    <div id="chat-header">Online Chat</div>
    <div id="chat-body">
      <p>Please wait while we connect you with a specialist...</p>
      <p>Would you like to play a game?</p>
      <button id="start-game-btn">Yes, I do 🎮</button>
    </div>
  </div>


  <!-- 🔹 Контейнер Unity -->
  <div id="unity-container" style="display:none;">
    <div id="loading-cover">Loading: 0%</div>
    <canvas id="unity-canvas" tabindex="-1"></canvas>
  </div>

  <style>
    /* 🔸 Кнопка вызова чата */
    #chat-toggle {
      position: fixed;
      bottom: 15px;
      right: 15px;
      background: #0078d4;
      color: white;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      font-size: 26px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      z-index: 9999;
      transition: 0.3s;
    }

    #chat-toggle:hover {
      background: #005fa3;
      transform: scale(1.05);
    }

    /* 🔸 Чат */
    #chat-window {
      position: fixed;
      bottom: 90px;
      right: 15px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
      display: none;
      flex-direction: column;
      overflow: hidden;
      z-index: 9998;
      font-family: sans-serif;
    }

    #chat-header {
      background: #0078d4;
      color: white;
      padding: 10px;
      font-weight: bold;
      text-align: center;
    }

    #chat-body {
      flex: 1;
      padding: 20px;
      font-size: 16px;
      color: #222;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    #chat-body button {
      margin-top: 20px;
      padding: 10px 20px;
      background: #0078d4;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    #chat-body button:hover {
      background: #005fa3;
    }

    /* 🔸 Игра */
    #unity-container {
      position: fixed;
      bottom: 90px;
      right: calc(15px + var(--chat-width, 320px) + 20px);
      background: #111;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
      z-index: 9997;
    }

    #unity-canvas {
      width: 100%;
      height: 100%;
      display: block;
      background: #231F20;
      object-fit: contain;
    }

    #loading-cover {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: sans-serif;
      font-size: 18px;
    }
  </style>

  <!-- 🔹 Логика -->
  <script src="Build/docs.loader.js"></script>
  <script>

    const btn = document.getElementById('start-game-btn');

    let hue = 0;
    let growing = true;
    let pulsing = true;

    function animateButton() {
      if (!pulsing) return;

      // Изменяем оттенок цвета (по кругу HSL)
      hue = (hue + 2) % 360;
      btn.style.backgroundColor = `hsl(${hue}, 90%, 55%)`;

      // Пульсация (scale)
      const scale = 1 + 0.5 * Math.sin(Date.now() / 200);
      btn.style.transform = `scale(${scale})`;

      requestAnimationFrame(animateButton);
    }

    // Запускаем анимацию
    animateButton();

    // Останавливаем после клика
    btn.addEventListener('click', () => {
      pulsing = false;
      btn.style.transform = 'scale(1)';
      btn.style.transition = 'transform 0.2s ease';
      btn.style.backgroundColor = "#0078D4"
    });

    const chatToggle = document.getElementById("chat-toggle");
    const chatWindow = document.getElementById("chat-window");
    chatWindow.style.display = "flex";
    const startGameBtn = document.getElementById("start-game-btn");
    const unityContainer = document.getElementById("unity-container");
    const loadingCover = document.getElementById("loading-cover");

    /* Соотношение 9:16 — как в твоей игре */
    const aspect = 9 / 16;

    /* функция выставления одинаковых размеров */
    function syncChatAndGameSize() {
      const vh = window.innerHeight * 0.6; // 60% высоты экрана
      const chatHeight = vh;
      const chatWidth = chatHeight * aspect;

      chatWindow.style.height = chatHeight + "px";
      chatWindow.style.width = chatWidth + "px";
      document.documentElement.style.setProperty('--chat-width', chatWidth + "px");

      unityContainer.style.height = chatHeight + "px";
      unityContainer.style.width = chatWidth + "px";
    }

    /* при загрузке и изменении размера */
    window.addEventListener("resize", syncChatAndGameSize);
    window.addEventListener("load", syncChatAndGameSize);

    /* Открыть/закрыть чат */
    chatToggle.addEventListener("click", () => {
      gtag('event', 'chatToggle', { event_category: 'engagement' });

      const isVisible = chatWindow.style.display === "flex";
      chatWindow.style.display = isVisible ? "none" : "flex";
      if (!isVisible) {
        syncChatAndGameSize();
        unityContainer.style.display = "none";
      }
    });

    /* Запуск игры */
    startGameBtn.addEventListener("click", () => {
      gtag('event', 'startGameBtn', { event_category: 'engagement' });

      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
      if (isMobile) {
        chatWindow.style.display = "none";   // скрыть окно чата
        // chatToggle.style.display = "none";   // скрыть кнопку вызова
        unityContainer.style.position = "fixed";
        unityContainer.style.bottom = "90px"; // как у чата
        unityContainer.style.right = "15px";  // как у чата
      }
      syncChatAndGameSize();
      unityContainer.style.display = "block";
      initUnityGame();
    });

    /* Инициализация Unity */
    function initUnityGame() {
      if (window.unityInitialized) return;
      window.unityInitialized = true;

      const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
      var pixelRatio;

      if (isMobile) {
        console.log("Mobile device detected, setting pixel ratio to 3");
        pixelRatio = 3;
      } else {
        console.log("Non-mobile device detected, using window.devicePixelRatio");
        if (window.devicePixelRatio === null) {
          console.log("window.devicePixelRatio is null, setting pixel ratio to 3");
          pixelRatio = 3;
        } else if (window.devicePixelRatio < 3) {
          pixelRatio = 3;
        } else {
          console.log("window.devicePixelRatio is valid, using it:", pixelRatio);
          pixelRatio = window.devicePixelRatio;
        }
      }

      console.log("window.devicePixelRatio:", window.devicePixelRatio);
      console.log("Using pixel ratio:", pixelRatio);

      createUnityInstance(document.querySelector("#unity-canvas"), {
        dataUrl: "Build/docs.data",
        frameworkUrl: "Build/docs.framework.js",
        codeUrl: "Build/docs.wasm",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "DefaultCompany",
        productName: "MVPPlatformer3D",
        productVersion: "0.1.0",
        webglContextAttributes: { preserveDrawingBuffer: true },
        matchWebGLToCanvasSize: true,
        devicePixelRatio: pixelRatio
      }, (progress) => {
        loadingCover.innerText = `Loading: ${Math.round(progress * 100)}%`;
      }).then(() => {
        setTimeout(() => loadingCover.remove(), 1000);
      }).catch((message) => {
        loadingCover.innerText = "Błąd ładowania: " + message;
      });
    }
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('a[href]').forEach(link => {
        link.addEventListener('click', () => {
          if (!link.href.includes(location.hostname)) {
            gtag('event', 'outbound_click', {
              event_category: 'outbound',
              event_label: link.href
            });
          }
        });
      });
    });
  </script>


</body>

</html>
